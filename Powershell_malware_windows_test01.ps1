# Description: 
#   Simple Powershell scripts to pull down an eicar file to audit and test malware detection and alerting
#   Multiple methods provided to test logging, alerting and powershell restrictions
#
# EICAR: 
#   The European Institute for Computer Antivirus Research (EICAR) has developed a test virus to test your antivirus appliance
#   More information on using eicar files to test scanners: https://www.eicar.org/download-anti-malware-testfile
# 
# eicar files to choose from:
# .com = https://secure.eicar.org/eicar.com
# .txt = https://secure.eicar.org/eicar.com.txt
# .zip = https://secure.eicar.org/eicar_com.zip
# .zip = https://secure.eicar.org/eicarcom2.zip

# Source URI
$source_uri = "https://secure.eicar.org/eicar_com.zip"
# Destation URI
$dest_uri = "C:\Users\$env:USERNAME\downloads\eicar_com.zip"

# Method 1 - Using Invoke-WebRequest
Invoke-WebRequest -Uri $source_uri -OutFile $dest_uri

# Method 2 - Using Invoke-WebRequest without Internet Explorer on host
Invoke-WebRequest -Uri $source_uri -OutFile $dest_uri -UseBasicParsing

# Method 3 - Using System.Net.WebClient
$client = new-object System.Net.WebClient
$client.DownloadFile($source_uri,$dest_uri)

# Method 4 - Using Start-BitsTransfer
Start-BitsTransfer -Source $source_uri -Destination $dest_uri
# Check if download has been completed
Get-BitsTransfer
